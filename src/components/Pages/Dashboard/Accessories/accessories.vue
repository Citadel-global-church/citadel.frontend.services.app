<template>
  <div>
    <div
      class="flex flex-col md:flex-row gap-y-4 md:gap-y-0 md:justify-between md:items-center mb-6 md:mb-4 w-full md:w-auto"
    >
      <div
        class="flex flex-col md:flex-row gap-y-4 md:gap-y-0 md:gap-x-4 items-center w-full md:w-auto"
      >
        <InputGroup
          v-model="query.searchParameter"
          placeholder="Search Accessories"
          type="search"
          prependIcon="heroicons-outline:search"
          classInput="w-full md:w-auto min-w-[320px] !h-9"
        />

        <!-- <Select
          label=""
          :options="filters"
          v-model="query.sortOrder"
          placeholder="Sort by"
          classInput="hidden bg-white !h-9 min-w-[150px]  !min-h-[36px] w-full md:w-auto"
        /> -->
      </div>

      <Button
        icon="heroicons-outline:plus"
        text="Add Accessory"
        btnClass="btn-primary btn-sm dark:bg-slate-800  h-min text-sm font-normal"
        iconClass="text-lg"
        @click="toggleAddAccessory"
      />
    </div>
    <GridSkletion :count="units.length" v-if="isSkeletion" />

    <Grid v-if="fillter === 'grid' && !isSkeletion" />

    <AddModal />
    <EditModal />
  </div>
</template>

<script setup>
import Button from "@/components/Button";
import GridSkletion from "@/components/Skeleton/grid";
// import Select from "@/components/Select";
import InputGroup from "@/components/InputGroup";
import { computed, ref, watch, onMounted, reactive, provide } from "vue";
import AddModal from "./accessory-add";
import EditModal from "./accessory-edit";
import Grid from "./accessory-grid";
import { useStore } from "vuex";

const store = useStore();
const { state } = useStore();
const userId = computed(() => state.auth.userData.id);

// const filters = [
//   {
//     label: "Name",
//     value: "zoneName",
//   },
//   {
//     label: "Description",
//     value: "description",
//   },
// ];
let fillter = ref("grid");
const toggleAddAccessory = () => {
  store.dispatch("toggleAddAccessory");
};

const width = ref(0);
const handleResize = () => {
  width.value = window.innerWidth;
};
onMounted(() => {
  window.addEventListener("resize", handleResize);
  handleResize();
});
const query = reactive({
  pageNumber: 1,
  pageSize: 25,
  sortOrder: null,
  searchParameter: null,
});
const units = computed(() => state.unit.units);

const isSkeletion = ref(true);
const isSkeletion2 = ref(null);
setTimeout(() => {
  isSkeletion.value = false;
  isSkeletion2.value = false;
}, 1000);

// watch fillter with switch case
watch(fillter, () => {
  switch (fillter.value) {
    case "grid":
      fillter.value = "grid";
      isSkeletion.value = true;
      setTimeout(() => {
        isSkeletion.value = false;
      }, 1000);

      break;
    case "list":
      fillter.value = "list";
      isSkeletion2.value = true;
      setTimeout(() => {
        isSkeletion2.value = false;
      }, 1000);
      break;
    default:
      fillter.value = "grid";
      break;
  }
});
provide("query", query);
provide("userId", userId);
</script>
<style lang=""></style>
